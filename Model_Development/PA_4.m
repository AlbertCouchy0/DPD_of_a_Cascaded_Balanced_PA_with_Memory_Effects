function output=PA_4(input)
% 设置输入
x = input;
x1 = Delay(input,1);
x2 = Delay(input,2);
x3 = Delay(input,3);
x4 = Delay(input,4);

% PA_4 Coefficients
cc_4 =[0.312178017697756 + 0.0376912810181483i
0.586326192820784 + 0.154779606922733i
-0.736989843059616 - 0.403614124716143i
0.648267195673922 + 0.435052494714415i
-0.253142108383135 - 0.202308724239608i
-0.0736614839819829 + 0.0570412443316344i
0.0104640230783694 + 0.00403520603733484i
-0.00234640418182987 + 0.00401595320389239i
0.00376098733858898 + 0.00740010234914179i
-0.0224405990610270 + 0.00570317148412838i
0.0103281431528267 - 0.00853202778676510i
0.115674427389709 - 0.0884834852267864i
-0.0889897377068798 + 0.0151697302490212i
-0.0296264033324594 + 0.373060570468796i
-0.162833415394177 - 0.0386615751605675i
0.161209719793417 - 0.220028469027218i
-0.00891541611848576 - 0.00723409652946210i
0.00558719657695678 + 0.00103950052846540i
-0.00680726751522917 + 0.00252056177767074i
-0.00169615037746454 - 0.00872952916352980i
-0.00464660937849257 + 0.000159907505812629i
0.00334487075517975 - 0.00260506494988461i
0.00317902041701623 + 0.00615136371924254i
0.0443135258182301 + 0.0172944642550634i
-0.0818180236866912 - 0.0164024181750913i
0.114178191370857 + 0.0395144800624786i
-0.0710996077908492 - 0.0349950950682769i
0.0128422512341881 + 0.0130061363470329i
0.00460394719470736 - 0.00179922309273367i
0.00142830230392562 + 0.00350784224878194i
0.00454660887474455 - 0.000600037983432639i
0.00174257137024166 + 0.00344648829104741i
0.0104934083258735 + 0.00308901127672462i
-0.00108869058570332 + 0.00344883928843973i
-0.00656305321139383 + 0.0179430369360364i
-0.00554283711399350 - 0.0379974069792217i
-0.0463223521079930 + 0.00243900472083780i
0.0505606006537194 + 0.00923162809873745i
0.00530648636558646 - 0.00441213455000188i
-0.00444977736554997 - 0.0137612607344456i
-0.00182020647771835 + 0.000135754450228079i
-0.00282985038051790 - 0.000347119110229110i
-0.000580465541533781 - 0.00382011326638504i
-0.00493407235903853 + 0.00161786552762327i
-0.00154880722740001 - 0.00680784650594302i
-0.00547155604916449 + 0.00163396458366080i
0.0112336089601316 - 0.0126380306462452i
0.0281457673432317 - 0.0206586466941510i
-0.0185888946139402 + 0.0306976771557338i
0.00415836878909042 + 0.0105435059439802i
-0.00846215706305956 - 0.00949247008404397i
-0.00177736142951389 + 0.00492707714571933i
0.00200916868875815 - 0.00496405386299541i
-0.00102626551966605 + 0.00177154525081105i
0.00448160896442998 - 9.23120797000840e-05i
9.14222737053438e-05 + 0.00379155423829582i
-0.00777202624896972 - 0.00278717968468997i
0.0109782172934861 - 0.00439530226251614i
-0.00352596713920783 + 0.0143006751377960i
-0.0104957697002832 - 0.0110215244371615i
0.0202843474260010 - 0.0949726301706342i
0.0148147625129097 + 0.00425600342580174i
0.0260741904176383 + 0.00765641392359230i
-0.00993677270793247 - 0.0123633655408389i
0.0503554011285401 - 0.00121507839758168i
-0.0377073513964149 + 0.0285636211518561i
-0.170742953888888 + 0.125827245278009i
0.157858800958953 - 0.0592112548677131i
0.0339710316385276 - 0.435143220578551i
0.154257598407241 + 0.155291912929172i
-0.0939578434114470 + 0.152015115513219i
0.0755960540603087 + 0.0502771119254286i
-0.0368263531802833 - 0.0350122634112015i
0.0236946845169208 - 0.00923964485448492i
0.00363076970978615 + 0.0218242469814828i
0.00922705714170100 - 0.0104795208744916i
0.00149744344177011 + 0.00504814088446348i
0.00188698793289310 - 0.0136117812136594i
-0.0472419068847185 - 0.0177551585919296i
0.121733760194295 + 0.0435378920145588i
-0.171048448229708 - 0.0752662261188219i
0.0876303898518587 + 0.0541324625839933i
-0.0614197308844358 - 0.0240829795412147i
-0.0144818098907372 + 0.00831357882079331i
-0.00694586218289461 - 0.00152964719205295i
-0.0110956162461148 + 0.00613186810918870i
-0.0101010296331607 - 0.00876804048762736i
-0.0205597340215817 + 0.00150490265489922i
-0.0165293144694687 - 0.00836889726730183i
0.00783270080108400 - 0.0322631399914399i
-0.00760236137835513 + 0.0540968072187047i
0.0737705474925873 + 0.00565194818444370i
-0.0544992276496510 - 0.0203310096267537i
-0.0163868841268737 - 0.00385703770683788i
0.0251528312975466 + 0.0351581137223399i
0.00391756089835295 - 0.00125892825027962i
0.00998152546384981 - 0.00105000835553376i
0.00279386694135408 + 0.00678012077702270i
0.0151478279063752 - 0.00843647530588260i
0.00817073019455555 + 0.0148109078799181i
0.0135223260951661 - 0.00338870683424666i
-0.0123918682585178 + 0.00751914343633153i
-0.0722412414940836 + 0.0670315230642518i
0.0233894846938575 - 0.0606635030957501i
-0.0146412664395300 - 0.0260949863064738i
0.0276926280213485 + 0.0330621174128753i
0.00232999081063817 - 0.0155503726929697i
-0.00533907677208645 + 0.0157416284005429i
0.00411922982420756 - 0.00535143102437935i
-0.0156419648335937 + 0.000554949377336511i
0.000165216618220221 - 0.00598684645744274i
0.0272403035319886 + 0.00992689913673062i
-0.0455664890968738 + 0.0177554966895216i
0.00249987395091544 - 0.0482890657690858i
0.0496082418289443 + 0.0296496497084233i
0.340868881598258 + 0.227003429802184i
-0.0975685055197769 + 0.0656375552818316i
-0.0688427989846032 + 0.0299108382011702i
-0.0369114841301371 + 0.0202722728047825i
-0.0343015607092945 + 0.0891051175575324i
-0.0213174715350198 + 0.129701455208968i
0.154164814863285 + 0.127549169758917i
0.0692638479751628 + 0.149246452733055i
0.207124089641939 + 0.160167591964853i
0.0328119928916832 - 0.229450388708482i
-0.0286728969951328 - 0.189308314002606i
0.0879711429161773 - 0.127236281074999i
0.00706117191638089 - 0.0238600909196731i
0.00637189388148057 - 0.0250332438380349i
-0.0116899753412047 - 0.0176253248408791i
-0.0143606862900342 - 0.0313744533694648i
-0.0315813295352687 - 0.0550023233575652i
-0.00376805244777276 - 0.0588446238467537i
-0.0820327906353399 - 0.0812146471335978i
-0.0282270007829512 - 0.0327149829328099i
0.0206536901015506 + 0.0266199885853131i
0.224224920339782 + 0.164931127649554i
0.192505529207860 + 0.0833444392464235i
0.00458416456786487 + 0.0196778484482747i
3.63059707669811e-05 + 0.00534121884013103i
0.00521080071889107 + 0.00616580863899999i
0.0125514982941471 + 0.0202483912680407i
0.0123496382555956 + 0.00664463415835490i
0.0319858931233217 + 0.0340435749652211i
0.00782265830373116 + 0.0222824757598383i
0.0480836679559654 - 0.00154723147949665i
-0.0285821354148466 + 0.0183805312524017i
0.119689330135772 - 0.0456478505666733i
0.110024026840670 - 0.0103621021844827i
0.00505375494422483 + 0.0128197948354215i
0.00221038300958995 + 0.000746943090486625i
-0.00579530493207217 - 0.00660721338440374i
-0.00126765227537209 - 0.000852310363512736i
-0.00944388984733326 - 0.00108091757345770i
-0.00375393935900704 - 0.0114425821785644i
-0.00536330710666827 + 0.0155375303589725i
-0.00174787404606502 - 0.00453943248483651i
-0.0654067529229141 - 0.0337149155803737i
0.202174893617713 + 0.0480582299869722i
0.359537290520783 + 0.223907992350092i
-0.0659098899272152 - 0.0457508962718048i
-0.0856430992589555 - 0.00494760355514001i
-0.0123853819851506 + 0.0323251524643071i
0.0326589739775522 + 0.0121055969726958i
0.0306975367433190 - 0.0258199466587881i
-0.132786539952807 + 0.00821927350073703i
-0.0141847822504977 - 0.00845804281782181i
-0.113013034172769 - 0.0129773037312929i
0.0244869955846010 + 0.214839018028921i
0.226763706351720 - 0.0691482603991498i
-0.399506900783599 - 0.188521798696907i
0.0454992025071284 - 0.0428183399424699i
0.0134038424690188 - 0.0473191469976695i
-0.0192239150824809 + 0.0136949571236927i
-0.0499389156396195 + 0.0365662804110363i
-0.00350838008821279 + 0.00452663843728207i
-0.0335144306446439 - 0.00445872706454437i
0.0327355985231297 + 0.00660677041836222i
-0.00446826059342782 - 0.0144220224948765i
-0.0236660743375791 - 0.0117478074749889i
-0.337476326394694 - 0.215074818334925i
0.325894102581160 + 0.176874245483676i
-0.0389906320942661 + 0.0912101303223982i
0.00164291856561846 + 0.0353461847303115i
0.0114961287985505 + 0.0126646057179102i
-0.000747965972933334 - 0.00343413325360667i
0.0140537897260831 + 0.00411217543859813i
-0.00430853322180394 - 0.00462893694210276i
0.0104671331905437 - 0.00687319765298861i
-0.0219877947087814 - 0.00975873214489381i
0.00268886125631951 - 0.0124441069103563i
0.322363816414954 + 0.258174356354482i
-0.118923012753308 - 0.0908343433419794i
-0.00636377597323223 - 0.0181477594783637i
-0.00586280168840227 - 0.0167125299691462i
0.00352791847497821 - 0.00409140494781972i
0.00398264436229157 - 0.000647142572138881i
0.000645978548641041 - 0.000356537502392090i
-0.00576167467040903 - 0.00284238937441111i
0.00200001405460550 + 0.00268068496619370i
0.00311283599521478 + 0.00651323743138542i
-0.00535697699695864 + 0.00557575485403158i
-0.134216542794545 - 0.111470947114194i
1.34387405473596 - 0.185045312913558i
-1.85991367816262 - 0.446670801920971i
-0.658594915558098 - 0.294895487566494i
-0.324204139086949 + 0.144655410710989i
0.316688023447779 - 0.0298405915312192i
0.344005466858025 + 0.130099137679676i
-0.0773045702821111 + 0.182351733251581i
0.221263098231661 + 0.337576736074578i
-0.274698916706491 - 0.0199642364644426i
-0.499492338647482 - 1.10931760543323i
-0.757574196044365 + 0.339803466419905i
-2.56424624976057 + 0.283599423300189i
3.55766903531616 + 0.248359405661432i
0.784463470234885 + 0.728091267454402i
0.315975378056056 - 0.344707717125156i
-0.417882557665063 - 0.00659750097803613i
-0.544780806537059 - 0.334810900655859i
0.375888914150478 - 0.173896199902330i
-1.10257328872630 - 1.00448263577287i
1.19951649479461 + 0.176880472084898i
-0.328905069784199 + 2.48362337636467i
1.82726281430757 - 0.687195396997554i
2.12192907332303 - 0.366464658992642i
-3.00559862435552 - 0.0454771154848324i
-0.390590222371918 - 0.720171560016240i
-0.0933555851798733 + 0.294367504533155i
0.238628916761673 - 0.0349844439959526i
0.409726733649823 + 0.302719446879761i
-0.548944421417303 - 0.0739586685742681i
1.27293109838834 + 1.04896576919619i
-1.38790831706707 - 0.389100188975390i
0.616724039928272 - 2.23664591288877i
-1.47366986899653 + 0.801512250223956i
-0.641698660941517 + 0.183534280518661i
0.980287334648630 + 0.0120390161633682i
0.0771850047067129 + 0.268532220933159i
0.00244241431017933 - 0.0917043352543066i
-0.0364131114927799 + 0.0197308275367885i
-0.117906593512277 - 0.117036771703031i
0.237840006811642 + 0.0837559382407249i
-0.497953207011424 - 0.413154287245676i
0.474036832326505 + 0.167780382145827i
-0.0974369998552405 + 0.901898339736508i
0.388564998412402 - 0.385839636608409i
-3.00824457961428 - 0.908448107330955i
-2.06569976632172 - 3.49191947785744i
2.77530486236640 + 2.48402620920633i
5.23367250797241 - 0.00676141248506079i
-1.56039688833870 + 2.16667202908444i
-0.280226132369332 + 0.166679110169814i
-0.256725114206054 + 0.867417464617095i
0.626191006976884 + 0.633432844596321i
0.149638221590052 - 0.543590520069780i
0.515845612949548 - 0.830241263755357i
1.18509660988324 + 1.63094694214657i
0.307656350516821 + 4.06198223164077i
2.35231472241284 + 0.802668307439287i
0.437892855609260 - 2.54654176830282i
-6.38394764708808 + 0.0637856125323850i
3.06166618337937 - 3.99618179498089i
-0.514824568940304 + 0.747371435476012i
0.812889699774539 - 2.08301398670347i
-0.709747788977285 - 1.28105407173464i
-0.573748469134017 + 1.80719505268307i
0.499168074170854 + 2.29055902491371i
-0.665795631154012 - 4.08353060798382i
-0.786010542369020 + 0.630480087852977i
0.849281090342402 - 1.06869403828366i
-1.56875138078823 - 1.74865682600521i
3.57535838166679 - 0.247415109969563i
-2.53015497552138 + 3.21070380607975i
1.04045150511008 - 1.37498224649845i
-0.864286070695753 + 2.03086698994108i
0.244911485187103 + 1.05492988621761i
0.432984233147266 - 1.86689275254145i
-0.917383182511145 - 2.23407927496114i
0.656374482609010 + 2.85332583342177i
0.262308785336648 - 1.26067360231130i
-0.214099793060628 + 0.170988028227415i
0.169090649047482 + 1.88688732156282i
-0.777644141566203 + 0.218430441284275i
0.825720089596807 - 1.04258305165126i
-0.490041038909435 + 0.642132200725666i
0.318359136878955 - 0.748249735346288i
0.0158793876724879 - 0.327330666354141i
-0.101059577667833 + 0.610010618095346i
0.356481611941668 + 1.03255118374739i
-0.275283484472023 - 0.819409306671558i];

thold=[0:0.1:1];
K=length(thold);

if length(x) == 0
	x=0;
end
if length(x1) == 0
	x1=0;
end
if length(x2) == 0
	x2=0;
end
if length(x3) == 0
	x3=0;
end
if length(x4) == 0
	x4=0;
end
xi=x;
X_lin=[];
X_1=[];
X_21=[];X_22=[];X_23=[];
X_ddr_1=[];X_ddr_2=[];
for m=0:4
	if m==0
		xi_shift = x;
	end
	if m==1
		xi_shift = x1;
	end
	if m==2
		xi_shift = x2;
	end	
	if m==3
		xi_shift = x3;
	end
	if m==4
		xi_shift = x4;
	end
    xip_shift=pi*angle(xi_shift)/180;
    X_lin=[X_lin xi_shift];
    for k=1:K
        xi_core=abs(abs(xi_shift)-thold(k));
        
        xi_1_shift=xi_core.*exp(1j*xip_shift);
        X_1=[X_1 xi_1_shift];
        
        xi_21_shift=xi_core.*exp(1j*xip_shift).*abs(xi);
        X_21=[X_21 xi_21_shift];
        if m>0
            xi_22_shift=xi_core.*xi;
            X_22=[X_22 xi_22_shift];
            xi_23_shift=xi_core.*xi_shift;
            X_23=[X_23 xi_23_shift];

            xi_ddr_core=abs(abs(xi)-thold(k));
            xi_ddr_1=xi_ddr_core.*xi_shift;
            X_ddr_1=[X_ddr_1 xi_ddr_1;];
            xi_ddr_2=xi_ddr_core.*xi.*xi.*conj(xi_shift);
            X_ddr_2=[X_ddr_2 xi_ddr_2];
        end
    end
end
X=[X_lin X_1 X_21 X_22 X_23 X_ddr_1 X_ddr_2];
y=X*cc_4;

% 设置输出
output=y;
end