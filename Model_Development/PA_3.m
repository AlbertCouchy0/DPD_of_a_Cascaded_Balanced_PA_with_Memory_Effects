function output=PA_3(input)
% 设置输入
x = input;
x1 = Delay(input,1);
x2 = Delay(input,2);
x3 = Delay(input,3);
x4 = Delay(input,4);

% PA_3 Coefficients
cc_3 =[0.331225248368359 - 0.0121589872390753i
0.189932101995104 + 0.155935968543202i
-0.375726102370359 - 0.204214099188188i
0.457688881469209 + 0.249143261073296i
-0.153126981923443 - 0.113491124562447i
-0.0687061079922520 + 0.104382089251469i
0.00267576282620571 + 0.00697133691086067i
-0.00902548407254686 - 0.00637981173338177i
-0.00227586182063066 - 0.00863332110865621i
0.000149976817133763 - 0.0101702084298192i
0.0119944850861375 - 0.0222696190909287i
-0.0405544613494638 + 0.0645375425374120i
0.149584102497291 - 0.0748794362188560i
-0.108683551535533 - 0.00414353879079536i
-0.173859829427951 + 0.348260525783303i
0.151079723311857 - 0.277291082724193i
-0.0192181547342497 + 0.00343506337198549i
0.0144695157197532 - 0.00100809810511016i
0.00223833834592198 + 0.00372324596671305i
-0.00449648453816810 - 0.00290537597909312i
0.00688166486200393 - 0.0119166444458235i
-0.00872352040715263 + 0.00843490570146177i
-0.00871169659896263 + 0.0142185271002789i
0.0142262167013486 + 0.0310036162526183i
0.0234820585732011 - 0.0347806409442292i
-0.150145704264359 - 0.00242824318386037i
0.111743700566853 + 0.00972914018503517i
0.00618556062502035 + 0.0211159046750125i
-0.000343690327523808 - 0.0107060972429276i
-0.00117264954887878 + 0.00537457296349105i
-0.00766942840489931 + 0.00287523446170674i
0.00345084224924939 + 0.00424825833384362i
-0.00676360365058498 - 0.0115231509887355i
0.0120011013869549 + 0.0291222842874879i
-0.0136265555131573 - 0.0253049687544803i
0.00620423767206185 + 0.0359136930966823i
0.0880268137814333 - 0.0221526752036527i
-0.0649810494923209 - 0.0147393809103263i
0.00558753884002436 - 0.00901598409719570i
0.0125909090040450 - 0.00563605199565402i
-0.00560121136261581 + 0.00531093486430843i
0.000396210497477219 - 0.00765329657055656i
0.00637533494118141 + 0.00304035008457327i
-0.000253107235243631 - 0.0115023558896767i
0.00367731717924854 + 0.00552110099905891i
-0.00417630767695093 - 0.0106472407808133i
0.00508168806193868 + 0.000950549365865403i
-0.00958639724922612 + 0.0244584695428667i
0.000723433896572427 - 0.00853384629384340i
-0.00815595959833566 - 0.00470932303136873i
0.00584115489871989 + 0.00805166923281311i
-0.00521758827265889 - 0.000963146934907267i
0.00365800571270615 + 0.00166063126731306i
0.000446433578849907 - 0.00141821730981511i
-0.00769881236380479 - 0.00126482466443510i
0.00737140694825909 + 0.00833542200890830i
-0.00285860945220234 + 0.000809036012853264i
-0.00457712458420758 - 0.0206446969917871i
-0.00277805400413391 + 0.0358791127395080i
0.00872102007221971 - 0.0258819028636302i
0.0348092881372236 - 0.129176316138041i
0.0449565326372151 - 0.0196797685062669i
0.0194126244204840 + 0.0472293828107310i
-0.00524470258647105 + 0.0138827510086680i
-0.0115351875864436 + 0.00280069220235415i
-0.0196302771742260 + 0.0213361284904494i
0.0614007184944786 - 0.106229835530031i
-0.209334575770991 + 0.106202184487715i
0.160556518911852 - 0.0126347349071443i
0.177386242005885 - 0.382608039519360i
-0.103517601481147 + 0.233557159160626i
0.0825568650197568 + 0.0396021095055809i
-0.0756987918183066 - 0.0232909782572483i
-0.00553167096605569 - 0.0149733632571960i
0.0187261491766258 + 0.0182207068371118i
-0.0202029109982136 + 0.0234960889277181i
0.0198927345395866 - 0.0182535261954816i
0.00897185796141325 - 0.0111501566046769i
-0.0245050118427976 - 0.0336286514950504i
-0.0173093001560772 + 0.0768034060562257i
0.184989089821750 - 0.00423505220558492i
-0.143584125383154 - 0.0608934037486625i
-0.0205758442246863 - 0.0744885167405889i
-0.000669386289495427 + 0.0326300158445611i
-0.00465141090316432 - 0.0141722073210013i
0.0220015415914252 - 0.00975712690770076i
-0.0163103834725498 - 0.0127929671903085i
0.0134350910010523 + 0.0250009857636471i
-0.0152418665018872 - 0.0728279725008093i
0.0171598626701507 + 0.0327814679036244i
-0.0197165213178567 - 0.0632103740890946i
-0.123176088858009 + 0.000680009528750424i
0.0892641284444171 + 0.0933199214141518i
-0.00409611037120879 + 0.0360772428981758i
-0.0274991032387172 + 0.00387732942313720i
0.0170891811566995 - 0.0135715791666211i
0.00331185831474141 + 0.0233062976824571i
-0.0151256043085245 - 0.00917902267097653i
0.00536299654436959 + 0.0308884335248127i
-0.0106601086768449 - 0.00827480646352842i
0.0219325874599635 + 0.0346969047557443i
-0.0281799679191781 - 0.00962840525601122i
0.0427483559653770 - 0.0359193372912880i
-0.0184884492921667 - 0.0125194869002329i
0.0247824446015482 + 0.0249223828268911i
-0.0217413150987301 - 0.0268143696310330i
0.0125176482893908 + 0.000597115124613883i
-0.00736663782899470 - 0.00238674820898477i
-0.00470098450437045 + 0.000959485369744583i
0.0224789354007893 + 0.00287353707553514i
-0.0283367334718573 - 0.0241252093828818i
0.0144820209316984 + 0.00955105865775277i
0.00314174169834715 + 0.0313257683891867i
0.0155812837624204 - 0.0638681316966688i
-0.0197200205494087 + 0.0583669426854110i
0.227684985562400 + 0.141991011878406i
-0.0292878360169778 + 0.00350064900309038i
-0.0340006401712362 + 0.00464249799815826i
0.00531021196793251 - 0.0123155099420133i
-0.0107322170881723 + 0.0386928740731261i
0.00299961460580666 + 0.0864439964176547i
0.00962178559954665 + 0.122742093351007i
0.185942865246415 + 0.143537613162696i
0.0560924241039478 + 0.149070104434551i
-0.238595577463803 - 0.0684670895876491i
0.103535798601958 - 0.154170520987580i
0.154786988917198 - 0.0457523901133454i
-0.00967902657408550 - 0.00740920196637991i
-0.0127788388928599 + 0.0101319613137862i
-0.0128100813779265 - 0.0173631249575231i
-0.0251412679992007 + 0.00273870866329540i
-0.0252089594107284 - 0.0525324287344544i
-0.0192842868769079 - 0.0501063716303320i
0.0195608027933781 - 0.0582354684054633i
-0.0375325006995294 - 0.0396678293003369i
0.123268204732694 + 0.0846357425141689i
0.176434179547233 + 0.0335731981199947i
0.191705897995652 + 0.0112742205372159i
0.00772162470721268 + 0.0163836978048743i
0.00157459244366170 - 0.00829189432631779i
0.0132291150708962 - 0.00145166529496115i
0.0119566348990507 + 0.0188767523744428i
0.00792712828804017 + 0.00842433236706690i
0.0109467610092564 + 0.00650072556394704i
0.00410463488326730 + 0.0435401630186500i
0.00690515131896747 - 0.00603018259183557i
-0.00905155322210226 - 0.0161382150987985i
0.139514244510660 - 0.0234538435103942i
0.166761304096466 - 0.0177993435951493i
-0.0121824549235620 - 0.00330705387105989i
0.00109047542134786 + 0.0149245081559847i
-0.00150055430389734 - 0.0149315187994801i
-0.00543652588361341 + 0.00498286423129708i
-0.00425074041076551 - 0.00282101386621479i
0.00356111071044216 + 0.00354150172852748i
-0.00834542670027560 - 0.0204372482871081i
-0.0108083766297271 + 0.0196579938895305i
0.0212324237250430 - 0.0241938108270409i
0.164458996609718 + 0.00562124073072288i
0.235787222005961 + 0.179106221740245i
-0.0222773946583723 - 0.0640999877971202i
-0.0652885487539635 + 0.00684197507519860i
-0.0496225313492536 + 0.0175022855035547i
0.0250362831801314 + 0.0339113322479168i
0.0122556278984245 + 0.00178052808501850i
0.0156922222262516 - 0.0225951016330890i
-0.173836854029749 - 0.0200731324448955i
-0.0151146942702305 - 0.0336493148784334i
0.207602763914645 + 0.0530176209855604i
-0.0458664911781494 - 0.0231729702881161i
-0.229765713374031 - 0.121284520914843i
0.00716731655744012 - 0.0350365084901220i
0.0256977802386601 - 0.0491724222822769i
-0.00658992293828007 - 0.0178898776486610i
-0.0261609733975258 + 0.0157242857585044i
-0.0242305434880229 + 0.0306059396439903i
0.000183696149596939 + 0.000459541350699386i
-0.0345612336656701 + 0.00869041541718100i
0.0298548092271709 + 0.0126243054788695i
-0.0859303758831468 - 0.0523604428828790i
-0.145951891333662 - 0.0829321965620312i
0.259254166505199 + 0.123864946145667i
-0.109390902911832 + 0.0131871190678780i
0.00342071666534005 + 0.0527708761026540i
0.00213570529809250 + 0.0219535670836965i
-0.000924417559414982 + 0.00104696889735322i
0.00408640519948294 - 0.000152564727443265i
0.00497931069320592 - 0.00585458652656751i
-0.00649572715824203 - 0.0181044180584711i
0.00729021222700199 - 0.00859277357105930i
-0.0168694348360160 - 6.77629560590238e-05i
0.198441500873082 + 0.125279633903637i
-0.0451573312235372 - 0.0308112106188014i
-0.0477257768382510 - 0.0506359420654546i
0.00270499777051081 - 0.00977487922163043i
-0.00293092507478999 - 0.0176358445361149i
0.00155278633023284 + 0.00556534182353812i
0.00945584850430582 - 0.00290113712938279i
-0.00111491434585901 + 0.00505862902504909i
-0.00124935065259954 + 0.00477311994635670i
-0.000600977967311137 + 0.00302317374908165i
0.00239062616538490 + 0.00647157810817053i
-0.107968470584182 - 0.0826761351707735i
0.0574734577112057 + 0.0337362208208710i
-0.108219616155392 - 0.464592280088885i
-0.183847822448209 + 0.0623171771920839i
-0.421978285396747 - 0.110489862576944i
0.169995119099130 + 0.0636822050428881i
0.119101723050023 - 0.341907201810520i
-0.109130172868616 + 0.331864567321556i
-0.372534141030222 + 0.412931009196873i
-0.265387073415460 - 0.238407612965042i
-0.121047069213391 - 0.450557557756181i
0.132451217289380 + 0.122200907129162i
0.288435781147566 - 0.100956807105437i
0.373835737332600 + 0.480960535692822i
-0.155558533675542 + 0.0158956008619099i
0.673465041041195 + 0.257082902478391i
-0.363710604342574 - 0.433088235805946i
-0.0168839014311927 + 0.606316433577871i
-0.189435409855692 - 0.733607095165959i
0.731138257154831 - 0.245634713818815i
0.128813209188725 + 0.0471955168897373i
1.12869316314155 + 1.04770529288774i
-0.664155392478411 - 0.103261761737066i
-0.386111954655744 - 0.0254015763681996i
-0.428672701026253 - 0.320236488992178i
0.361944780455985 - 0.129439939495164i
-0.466801130237413 - 0.244084942989303i
0.324809072602627 + 0.441934435868742i
-0.132123961444608 - 0.525087841492619i
0.406011474695264 + 0.611112336819643i
-0.708114656197236 - 0.221823412514453i
0.0781977172635834 + 0.292838972509347i
-1.46391610133894 - 1.17849775240075i
0.843807542514986 + 0.274548292196040i
0.119263338046019 + 0.0505864336168108i
0.174609695501678 + 0.115686712608974i
-0.160079137425171 + 0.0808807756354841i
0.140305982077403 + 0.0898996373403178i
-0.108155692001305 - 0.158941015163148i
0.0947517374684891 + 0.168704994315345i
-0.192423272092086 - 0.208242802998002i
0.236225131041933 + 0.189490435028899i
-0.0413404264005211 - 0.198307163582371i
0.484504991848901 + 0.518140313340415i
-0.272388528544915 - 0.164074643957128i
0.992219008941212 - 4.55269891728663i
-5.57423083460899 - 5.93904539852188i
0.127516404381062 + 6.94089103993541i
6.18177068013058 + 5.92063922347214i
-1.32791597582326 - 0.420633185714582i
0.498985021831300 + 1.01298089664666i
0.789841883758715 - 0.287493475749627i
-0.758270297983700 - 0.172003194551772i
1.15752025361894 + 0.477439547174241i
-0.912088020717807 + 0.310696589748584i
1.04526438782439 + 2.25874597636038i
3.47823833169050 + 7.99285256351615i
-0.715239876343930 + 4.27129444846244i
2.52398082713167 - 6.52783225355210i
-10.6890115165371 - 12.0399072093711i
5.71704932906789 + 3.86571901518765i
-1.46582778136351 - 1.49860204795435i
-1.20499098506431 + 0.347249247013742i
2.11450254223800 - 0.492543630140298i
-3.00933829475381 - 0.134359348540420i
2.04409398237760 - 0.215959916889704i
-1.50894823249509 - 2.95221680551495i
0.652738084496507 - 1.58244358443661i
-1.83042820144231 - 3.03888719255047i
-2.21034860498943 - 0.418920170990984i
8.20021144261059 + 10.2776949317346i
-6.27342713003704 - 4.92238680004174i
1.53909918099818 + 0.876246433220825i
0.810512880488666 - 0.137010669703903i
-2.10567434232346 + 0.977724856421022i
2.94879303719502 - 0.441243624956328i
-2.21860015742721 + 0.134433582496974i
0.835170642630887 + 0.929211317957659i
-1.59715881520202 + 0.0812446618776063i
2.23899309703198 - 0.301794076129737i
0.236952679132826 + 1.82035849340292i
-2.43779956864450 - 3.33878920751875i
2.32617999801806 + 2.04913984959218i
-0.541292976354143 - 0.207884916369647i
-0.227632211126437 - 0.000547342739061323i
0.777765434289498 - 0.522151599700850i
-1.08615292040794 + 0.395148726681564i
0.998418113051064 - 0.133525874726988i
-0.280943481844018 + 0.0920416511845907i];

thold=[0:0.1:1];
K=length(thold);

if length(x) == 0
	x=0;
end
if length(x1) == 0
	x1=0;
end
if length(x2) == 0
	x2=0;
end
if length(x3) == 0
	x3=0;
end
if length(x4) == 0
	x4=0;
end
xi=x;
X_lin=[];
X_1=[];
X_21=[];X_22=[];X_23=[];
X_ddr_1=[];X_ddr_2=[];
for m=0:4
	if m==0
		xi_shift = x;
	end
	if m==1
		xi_shift = x1;
	end
	if m==2
		xi_shift = x2;
	end	
	if m==3
		xi_shift = x3;
	end
	if m==4
		xi_shift = x4;
	end
    xip_shift=pi*angle(xi_shift)/180;
    X_lin=[X_lin xi_shift];
    for k=1:K
        xi_core=abs(abs(xi_shift)-thold(k));
        
        xi_1_shift=xi_core.*exp(1j*xip_shift);
        X_1=[X_1 xi_1_shift];
        
        xi_21_shift=xi_core.*exp(1j*xip_shift).*abs(xi);
        X_21=[X_21 xi_21_shift];
        if m>0
            xi_22_shift=xi_core.*xi;
            X_22=[X_22 xi_22_shift];
            xi_23_shift=xi_core.*xi_shift;
            X_23=[X_23 xi_23_shift];

            xi_ddr_core=abs(abs(xi)-thold(k));
            xi_ddr_1=xi_ddr_core.*xi_shift;
            X_ddr_1=[X_ddr_1 xi_ddr_1;];
            xi_ddr_2=xi_ddr_core.*xi.*xi.*conj(xi_shift);
            X_ddr_2=[X_ddr_2 xi_ddr_2];
        end
    end
end
X=[X_lin X_1 X_21 X_22 X_23 X_ddr_1 X_ddr_2];
y=X*cc_3;

% 设置输出
output=y;
end