function output=PA_2(input)
% 设置输入
x = input;
x1 = Delay(input,1);
x2 = Delay(input,2);
x3 = Delay(input,3);
x4 = Delay(input,4);

% PA_2 Coefficients
cc_2 =[0.277967208448578 - 0.0239612658436372i
0.505489557560034 + 0.129327774988887i
-0.843462676781465 - 0.192443442209186i
0.895574440457131 + 0.275431069343176i
-0.350606939436551 - 0.138238962900520i
-0.0997659572181564 - 0.188883728076805i
0.00967694964758996 + 0.00250491030504556i
-0.00335536572024397 + 0.00394073998269576i
0.00234857902260568 + 0.00954723010930597i
-0.0213107369019329 + 0.00171214580368613i
0.0426856381354771 - 0.0176215976027778i
0.0192153099331185 - 0.00456631837529018i
-0.158327720936535 + 0.117687951498569i
0.196066280141913 + 0.261885220094729i
-0.336593537152667 - 0.828602267410574i
0.224599800926634 + 0.462435789792176i
-0.0102217482305151 - 0.0327041768017611i
0.0102538270269649 - 0.00232437192815904i
-0.00774171866734218 - 0.00115087197396695i
-0.00139632458612245 - 0.0106814249536227i
-0.00621817814911867 - 0.00364284522712832i
0.00452842028858519 + 0.000662231960756265i
-0.00816744436254582 - 0.00328261683460773i
0.00967232034789379 - 0.0149069078150169i
-0.0321106835088927 + 0.0285911447397965i
0.139737604373051 - 0.0767964298181520i
-0.102080964795003 + 0.0638238043277148i
0.00750138895036481 + 0.0313362020087696i
0.00111163625949060 - 0.00300110385514952i
0.00207143741606859 + 0.00858851936224130i
-0.000411039180525109 + 0.00263307584038107i
0.00673498943825220 + 0.00548257917625758i
0.00511874760300611 + 0.0117295764925224i
0.00830646292618460 - 0.00138228161647357i
-0.0114216376832674 + 0.0137218810793590i
-0.0368083716901788 - 0.0227499836797105i
0.0449836961598505 - 0.00809649294028651i
-0.00720178526552287 + 0.00779788804773134i
0.00721532888620854 - 0.00883116076696235i
0.00907239777276443 - 0.0156900581585049i
-0.00880470403316355 + 8.87350221728880e-05i
-0.00156664112933223 - 0.00587406929748967i
0.00379186332797608 - 0.00343428642257096i
-0.00503795802294861 - 0.00151567174661168i
0.000324254202011860 - 0.00206503741252376i
-0.00744804357675369 - 0.0141948998812163i
0.00998337164283472 + 0.0268991683267356i
0.0156799479493186 - 0.0383300956294683i
-0.00872473205169235 + 0.0243540802638029i
0.00122850806574854 + 0.00433291242210052i
-0.00582745546276762 - 0.00415372453150746i
-0.00674812733251588 + 0.00489530433825517i
0.00833259848600104 - 0.00455229263376786i
-0.00460894691825558 + 0.000984227193492469i
0.00147127987941456 + 0.00278138934887164i
-0.00170558708113289 + 0.00394629630094767i
0.00769407167219340 - 0.00608952007940035i
-0.0110682421242937 - 0.00500613617937395i
-0.00528109437125010 - 0.00697648408549468i
0.00525417961315768 + 0.00947808390383730i
0.0563685725415055 + 0.139705872677116i
0.0222312400477312 + 0.0153674585927626i
0.0239989545568421 - 0.000203486082288037i
-0.00640690667311407 - 0.0201049578898063i
0.0422351499918368 + 0.00574019019978316i
-0.0879038677241977 + 0.0374823322687401i
-0.0108056445802717 - 0.00648025426754096i
0.205964042185109 - 0.156846366572642i
-0.255371342929736 - 0.252306755109774i
0.386146264599343 + 0.917582266199105i
-0.156135870206367 - 0.328593292293024i
0.0747161304412479 + 0.0999933177746270i
-0.0610358525192293 - 0.0198365969636905i
0.0276013723555022 - 0.00262440769471605i
0.000707490544159032 + 0.0272023192512886i
0.00881293848286800 - 0.000750537655112806i
-0.00347860701808235 + 0.00399457790030368i
0.0175884858160686 + 0.00581494484005110i
-0.0135829595447588 + 0.0280223149058673i
0.0314886382186788 - 0.0425042607115602i
-0.171725433463779 + 0.0962938873537827i
0.123062972681505 - 0.0859447916528561i
-0.0342218748997242 - 0.0774248311782908i
-0.00179385314957940 + 0.0133910028108413i
-0.00969106569585674 - 0.0173799234200427i
0.00582553951878218 - 0.00196152929022642i
-0.0250148233351058 - 0.0161409053249291i
-0.00121073235892278 - 0.0241489619090320i
-0.0234101646571266 + 0.00575162365133927i
0.0236754661556771 - 0.0222453355499952i
0.0687340224274825 + 0.0203105525208700i
-0.0942291034980137 + 0.0562242541361366i
0.0214397559256039 - 0.0382384342978872i
-0.0233506074433671 + 0.0117875409224416i
-0.0163785950669297 + 0.0401114386031354i
0.0277291692033701 - 0.000398592393862877i
0.00448534540358880 + 0.0157034002093895i
-0.0115104050978779 + 0.00667602084401728i
0.0144341833638005 - 0.00297729200806258i
-0.00547909510651902 + 0.00503919589650025i
0.00792443789046943 + 0.0327111895676435i
-0.0108008615729453 - 0.0752399974589823i
-0.0141670934794237 + 0.0820076146329977i
-0.00777930946843405 - 0.0320282075432041i
0.000321424758206384 - 0.00696181671144224i
0.0168865686307941 + 0.0141678329941254i
0.0173659134301730 - 0.0155407695001197i
-0.0220529273247310 + 0.0153316223790662i
0.0126449256055811 - 0.00431419502260029i
-0.00364863089767288 - 0.00626492021891308i
0.00614730257201147 - 0.00720462873102638i
-0.0187433795796511 + 0.0173151681917779i
0.0249437747163063 + 0.0279235036459231i
0.0428022573639659 - 0.00137884481463763i
-0.0346332588666701 - 0.0213293751253567i
0.507847889662965 + 0.167193797026596i
-0.0687289768656320 + 0.00577289366414886i
-0.0437370360131279 - 0.0266285786962282i
-0.00860552495565353 - 0.0239547175218024i
-0.00659630402085908 + 0.0476527782816668i
-0.0133249491460711 + 0.102005332879277i
0.125035181575185 + 0.133732383557673i
0.129286078890640 + 0.157268971591817i
0.0644555333978506 + 0.140192328771775i
0.372187028614556 + 0.0193216410207572i
-0.229890993452357 - 0.191163029752705i
0.0857068544339842 - 0.0600193968278478i
-0.00301213583110021 + 0.00558302599841456i
-0.00665016207590874 + 0.0145801940794874i
-0.0222144790679980 + 0.0100390419775773i
-0.0219181048746279 - 0.00340960410574061i
-0.0468535882506846 - 0.0482058196581526i
-0.00391456578879580 - 0.0609286117008107i
-0.0480540538846752 - 0.0812249489436284i
0.00606540825706328 + 0.00514708968158998i
0.0540524695552612 - 0.00241424093503059i
0.192247772168600 + 0.0360498468933341i
0.179518967224114 + 0.0373853567687298i
0.00712421934049564 - 0.00828952652036090i
0.00505026170650345 - 0.00630256431893112i
0.00690889194103800 - 0.0114109667315870i
0.0155010998020301 + 0.0134287764119035i
0.0148211802611015 + 0.00512918079827173i
0.0253479063404656 + 0.0306366840126764i
0.00387443625015627 + 0.0254085358450758i
-0.00295293669221151 - 0.0127432259522388i
0.0231363322445436 + 0.0763693905393042i
0.0984357984033464 - 0.0613554665026628i
0.112213267823101 - 0.0261671149750562i
0.000181450018977046 + 0.00723028665627162i
0.00192873616660228 + 0.00948708041480562i
-0.00524602578024524 - 0.00893393550551260i
-0.00100559663223080 + 0.00431376236001049i
-0.00896250797170446 - 3.29608073180197e-05i
-0.00266968838558671 - 0.0155967468131160i
-0.00127262641810580 + 0.0182160444365684i
0.0135798249492492 - 0.0111882907058945i
-0.0513470883745768 - 0.0255792527859136i
0.165743700179200 + 0.00219906459332753i
0.167916852770460 + 0.126792137643932i
-0.0532285213738245 - 0.0491328491362837i
-0.0866455875111305 + 0.0102573415246105i
-0.0238016705924681 + 0.0325768450429795i
0.0256322010567679 + 0.0231952353783068i
0.0425948615657347 - 0.0100512511878862i
-0.0950437205414054 - 0.00918818488897587i
-0.0767653034987889 - 0.00333802554062531i
-0.00996245100804945 - 0.00278442504981691i
-0.337793144188643 - 0.0312766668320994i
0.337613979701315 + 0.00253927387890538i
-0.446395294408024 - 0.100038877798620i
0.0408000401712033 - 0.0433294763861223i
0.0169397617117199 - 0.0577864837896784i
-0.0121633324362371 - 0.00193239489937834i
-0.0477432263620509 + 0.0308743600038705i
0.000291389741959291 + 0.00881658492114498i
-0.0353262926292418 - 0.00164334902215188i
0.0171245412645605 + 0.00982874559203808i
-0.0193130985002949 - 0.0255727297844660i
0.00444917197766020 - 0.00107636896045052i
-0.397065390336789 - 0.0923923441952037i
0.443232088443705 + 0.0809486775422134i
-0.0383492505915028 + 0.101631325693787i
-0.00422664523876538 + 0.0436268166444110i
0.0113394025127861 + 0.0190140386011352i
-0.00316242494272007 + 0.000218590950457191i
0.0110715502006814 + 0.00495708022323440i
-0.00716382962036786 - 0.00680159380481128i
0.0104949079996191 - 0.0115002739706684i
-0.0127427522157635 - 0.00518472305794860i
-0.0122172486112870 - 0.0528915659512760i
0.452320731922194 + 0.194479987458021i
-0.183125656844959 - 0.0513692225155513i
0.0204170612786457 - 0.0242990516980724i
-0.00802971990788287 - 0.0220515448093250i
0.00411537799510878 - 0.00330267834346886i
0.00375285059496065 - 0.00359053997184933i
0.00317366748369128 - 0.00124852560873648i
-0.000750286042808779 + 0.00251191106713217i
-0.00179200722789070 - 0.000218163769089816i
0.00868968851510519 + 0.00806392904652555i
-0.0197586147853699 + 0.0176798104304898i
-0.167488750359368 - 0.0868732319960051i
1.09087312338585 + 0.627818469429462i
-1.28453025007211 - 1.05300068214944i
-0.807222906646300 - 0.00922798601541186i
-0.0507079377847784 + 0.137773955575795i
0.308223622258667 + 0.0405546869996547i
0.259367474849858 + 0.0219715404275462i
-0.230527325863844 + 0.276315811129154i
-0.632525738268223 - 0.0942559958549370i
0.718319055675677 + 1.20975109936210i
-0.562241420417949 - 0.790679864630543i
-0.585340712263882 - 0.498485538939827i
-1.24075776281639 - 1.46939275781311i
2.21357715905908 + 1.79390230391606i
1.23640802892170 + 0.0718206915597942i
-0.388385713112006 - 0.274147797596078i
-0.332597203351489 - 0.126710463365590i
-0.524793581321342 - 0.0978081638060501i
0.711595662730745 - 0.533036811436797i
0.445371007704595 - 0.145891171632927i
-1.19494394243811 - 2.30339839822213i
2.20907042214361 + 1.68697349102563i
0.397296926869878 + 1.27696316951826i
0.627999821590918 + 1.20606353138461i
-1.75324049595472 - 1.54901990050001i
-0.881659177557916 - 0.0970011773279400i
0.602453667623132 + 0.218945108924984i
0.103914281041254 + 0.0517123718258069i
0.481436910304653 + 0.0724983495997904i
-0.860986180091649 + 0.295075570120959i
0.0612163989313563 + 0.286786156873735i
0.883064058032757 + 1.86775623967260i
-2.66728968581623 - 1.68657293943528i
0.267552945201827 - 0.930638092813258i
-0.103860090901649 - 0.382332294400505i
0.543763792592137 + 0.550067757698594i
0.265996242244573 + 0.0464984466131585i
-0.252373651186921 - 0.0649724970483176i
0.0262826037637541 - 0.00223830133755450i
-0.165662915456207 - 0.0320518238535060i
0.355725785892747 - 0.0566278469647835i
-0.152158883336076 - 0.139913881442760i
-0.264326753042891 - 0.615727705118271i
1.10024400199177 + 0.671006473998760i
-0.246756348844763 + 0.244087543594141i
-2.45421888141631 - 1.80630906706096i
-2.30338187785619 - 3.62929132863442i
2.35033218920113 + 3.65754765531719i
4.40288344614057 + 0.626932739158306i
-0.486927466473206 + 1.67609207004456i
-1.52986662621111 + 0.400000592472190i
1.41368538303810 + 1.77532239127114i
0.291254165811096 + 0.201181253139595i
-0.613678646314153 - 0.926437313354192i
-1.15651045861003 - 0.353712996615311i
2.41303959985928 + 2.07991993338267i
0.363674778473836 + 4.20703866104241i
2.52095928801915 + 1.20111764170402i
-0.569062750404691 - 4.31739289578221i
-5.11018932986450 + 0.0741859876181611i
0.890904369807299 - 2.44931519895727i
4.05835468469133 + 0.612977175200706i
-3.86037284284631 - 4.18647518165920i
1.16736811851251 - 0.0438880891321125i
0.121273590065862 + 1.48632015084849i
2.82058033703203 + 1.86704585435278i
-2.64359702929657 - 3.33208898074423i
-1.12241427747964 + 0.567250825672255i
0.645263926026679 - 0.671455826514160i
0.0369502253213161 - 0.248432506152457i
2.62014081271745 - 1.07551349683172i
-0.570707246732567 + 1.61804249922112i
-4.01108197290094 - 1.44244987320509i
3.95038358591037 + 3.93015019353816i
-2.04655956231438 + 0.0175514729550605i
0.475513836013756 - 1.19522978935070i
-2.55221679161034 - 2.00291273270693i
1.86694499329650 + 1.64547606039740i
0.572906621498323 - 1.66551033324326i
-0.322063654225117 + 0.424885238951242i
-0.486870785191366 + 1.22217829356920i
-0.494605176086946 + 0.734688472174479i
0.139927204781229 - 0.449642017264096i
1.46320465622663 + 0.684313721494175i
-1.48543884217839 - 1.36038941173119i
0.979556861217496 - 0.0515899760928538i
-0.339081367115740 + 0.377795890064138i
0.823292049273283 + 0.762849510236339i
-0.531281547053240 - 0.114536163804453i];

thold=[0:0.1:1];
K=length(thold);

if length(x) == 0
	x=0;
end
if length(x1) == 0
	x1=0;
end
if length(x2) == 0
	x2=0;
end
if length(x3) == 0
	x3=0;
end
if length(x4) == 0
	x4=0;
end
xi=x;
X_lin=[];
X_1=[];
X_21=[];X_22=[];X_23=[];
X_ddr_1=[];X_ddr_2=[];
for m=0:4
	if m==0
		xi_shift = x;
	end
	if m==1
		xi_shift = x1;
	end
	if m==2
		xi_shift = x2;
	end	
	if m==3
		xi_shift = x3;
	end
	if m==4
		xi_shift = x4;
	end
    xip_shift=pi*angle(xi_shift)/180;
    X_lin=[X_lin xi_shift];
    for k=1:K
        xi_core=abs(abs(xi_shift)-thold(k));
        
        xi_1_shift=xi_core.*exp(1j*xip_shift);
        X_1=[X_1 xi_1_shift];
        
        xi_21_shift=xi_core.*exp(1j*xip_shift).*abs(xi);
        X_21=[X_21 xi_21_shift];
        if m>0
            xi_22_shift=xi_core.*xi;
            X_22=[X_22 xi_22_shift];
            xi_23_shift=xi_core.*xi_shift;
            X_23=[X_23 xi_23_shift];

            xi_ddr_core=abs(abs(xi)-thold(k));
            xi_ddr_1=xi_ddr_core.*xi_shift;
            X_ddr_1=[X_ddr_1 xi_ddr_1;];
            xi_ddr_2=xi_ddr_core.*xi.*xi.*conj(xi_shift);
            X_ddr_2=[X_ddr_2 xi_ddr_2];
        end
    end
end
X=[X_lin X_1 X_21 X_22 X_23 X_ddr_1 X_ddr_2];
y=X*cc_2;

% 设置输出
output=y;
end